<!-- ---
// src/pages/wp-explorer.astro
// WordPress REST API Explorer page for development

import { WPRestClient } from '@/lib/API/explore';

// Only run this in development
if (import.meta.env.DEV) {
	const client = new WPRestClient({
		baseUrl: 'http://your-local-wp-site.local', // Replace with your LocalWP URL
		username: 'your-username', // Replace with your WP username
		password: 'your-app-password', // Use Application Passwords
	});

	try {
		console.log('=== WordPress REST API Explorer ===');

		// Test connection
		const connected = await client.testConnection();
		console.log('Connected to WordPress:', connected);

		if (connected) {
			// Discover post types
			const postTypes = await client.discoverPostTypes();

			// Get sample data from custom post types
			const customPostTypes = [
				'alice_hub_program',
				'alice_stats',
				'food_pantry',
				'alice_report_page',
				// Add your other custom post types here
			];

			for (const postType of customPostTypes) {
				try {
					console.log(`\n--- Exploring ${postType} ---`);
					const sampleData = await client.getSampleData(postType, 3);

					if (sampleData.length > 0) {
						console.log(`Found ${sampleData.length} ${postType} posts`);
						console.log('Sample structure:', Object.keys(sampleData[0]));

						// Log ACF fields if they exist
						if (sampleData[0].acf) {
							console.log('ACF Fields:', Object.keys(sampleData[0].acf));
						}
					}
				} catch (error) {
					console.log(`${postType}: No data or endpoint not available`);
				}
			}
		}
	} catch (error) {
		console.error('Explorer error:', error);
	}
}
---

<html>
	<head>
		<title>WordPress REST API Explorer</title>
		<style>
			body {
				font-family: monospace;
				max-width: 1200px;
				margin: 0 auto;
				padding: 20px;
				background: #1a1a1a;
				color: #00ff00;
			}
			.container {
				background: #000;
				padding: 20px;
				border-radius: 8px;
				border: 1px solid #333;
			}
			h1 {
				color: #00ff00;
				border-bottom: 2px solid #00ff00;
				padding-bottom: 10px;
			}
			.status {
				padding: 10px;
				margin: 10px 0;
				border-radius: 4px;
			}
			.success {
				background: #001100;
				border: 1px solid #00ff00;
			}
			.error {
				background: #110000;
				border: 1px solid #ff0000;
				color: #ff0000;
			}
			.info {
				background: #001122;
				border: 1px solid #0088ff;
				color: #0088ff;
			}
			pre {
				background: #111;
				padding: 10px;
				border-radius: 4px;
				overflow-x: auto;
			}
			.endpoint {
				background: #222;
				padding: 10px;
				margin: 10px 0;
				border-left: 4px solid #00ff00;
			}
			button {
				background: #00ff00;
				color: #000;
				border: none;
				padding: 10px 20px;
				margin: 10px;
				border-radius: 4px;
				cursor: pointer;
				font-weight: bold;
			}
			button:hover {
				background: #00cc00;
			}
		</style>
	</head>
	<body>
		<div class='container'>
			<h1>üîç WordPress REST API Explorer</h1>

			<div class='status info'>
				<strong>Development Mode:</strong> Check your browser console for detailed API exploration results.
			</div>

			<div class='endpoint'>
				<h3>üîó Common Endpoints</h3>
				<p><strong>Base URL:</strong> <code>http://your-local-wp-site.local/wp-json/wp/v2</code></p>

				<h4>Discovery Endpoints:</h4>
				<ul>
					<li><code>/types</code> - List all post types</li>
					<li><code>/posts</code> - WordPress posts</li>
					<li><code>/pages</code> - WordPress pages</li>
				</ul>

				<h4>Your Custom Post Types:</h4>
				<ul>
					<li><code>/alice_hub_program</code></li>
					<li><code>/alice_stats</code></li>
					<li><code>/food_pantry</code></li>
					<li><code>/alice_report_page</code></li>
					<li>...and others based on your plugin</li>
				</ul>
			</div>

			<div class='endpoint'>
				<h3>üìù Next Steps</h3>
				<ol>
					<li><strong>Update Configuration:</strong> Replace the placeholder URLs and credentials in the code</li>
					<li><strong>Set up Application Passwords:</strong> In WP Admin ‚Üí Users ‚Üí Your Profile ‚Üí Application Passwords</li>
					<li><strong>Run the Explorer:</strong> Visit this page and check the console</li>
					<li><strong>Identify Data Structure:</strong> See what fields your custom post types have</li>
					<li><strong>Create Import Script:</strong> Use the batch creation methods to import your JSON data</li>
				</ol>
			</div>

			<div class='endpoint'>
				<h3>üõ†Ô∏è Quick Test</h3>
				<p>Test these URLs directly in your browser:</p>
				<pre>
http://your-local-wp-site.local/wp-json/wp/v2/types
http://your-local-wp-site.local/wp-json/wp/v2/alice_hub_program
http://your-local-wp-site.local/wp-json/wp/v2/alice_stats
      </pre>
			</div>

			<div class='status success'>
				<strong>Pro Tip:</strong> Use the browser's Network tab to see the exact API responses and structure.
			</div>
		</div>

		<script>
			// Declare the wpExplorer property on Window interface
			declare global {
				interface Window {
					wpExplorer: any;
				}
			}
			// Client-side exploration for interactive testing
			window.wpExplorer = {
				async testEndpoint(endpoint) {
					try {
						const response = await fetch(`http://your-local-wp-site.local/wp-json/wp/v2${endpoint}`);
						const data = await response.json();
						console.log(`Endpoint ${endpoint}:`, data);
						return data;
					} catch (error) {
						console.error(`Error testing ${endpoint}:`, error);
					}
				},

				async explorePostType(postType) {
					console.log(`\n--- Exploring ${postType} ---`);
					return await this.testEndpoint(`/${postType}?per_page=5&_fields=id,title,acf,meta`);
				},
			};

			console.log('WordPress Explorer loaded. Try:');
			console.log('wpExplorer.testEndpoint("/types")');
			console.log('wpExplorer.explorePostType("alice_hub_program")');
		</script>
	</body>
</html> -->
